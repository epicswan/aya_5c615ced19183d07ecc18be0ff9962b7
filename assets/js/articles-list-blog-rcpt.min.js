!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("SectionRcpt"),require("axios"),require("PaginationRcpt"),require("CardLayoutRcpt"),require("UtilsRcpt"),require("moment")):"function"==typeof define&&define.amd?define(["react","SectionRcpt","axios","PaginationRcpt","CardLayoutRcpt","UtilsRcpt","moment"],t):"object"==typeof exports?exports.ArticleListBlogRcpt=t(require("react"),require("SectionRcpt"),require("axios"),require("PaginationRcpt"),require("CardLayoutRcpt"),require("UtilsRcpt"),require("moment")):e.ArticleListBlogRcpt=t(e.React,e.SectionRcpt,e.axios,e.PaginationRcpt,e.CardLayoutRcpt,e.UtilsRcpt,e.moment)}("undefined"!=typeof self?self:this,function(e,t,n,r,i,a,o){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=i.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(2),p=r(u),f=n(3),d=r(f),m=n(4),g=r(m),h=n(5),b=r(h),v=n(6),y=r(v),x=n(7),_=r(x),w=_.default._store.getEnv(),I=w.scheme,k=w.domain,P=w.subdomain,O=w.apiProd,C=w.domainApi,R=O?P:"blog",j=(I+"://"+R+"."+(O?C:k)).replace("__API__","blog");n(8)().format();var E,q=g.default.CancelToken,A=_.default._css,L=_.default._getSrcSet,M=function(e){function t(e){a(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.cachedItems=null,n.blogModule=_.default._store.getUidSite("blog");var r={1:"col",2:"col-md-6",3:"col-md-4",4:"col-md-3"};if(n.props.items.items.length>0){var i=n.props.items,s=i.numItems,c=i.page,l=i.totalItems;n.state={cancelToken:null,forcePage:1,inLoading:!0,items:n.transformItems(n.props.items.items),numItems:s,page:c,totalItems:l,grid:r}}else n.state={cancelToken:null,forcePage:1,items:[],grid:r,inLoading:!0};return n.refArticles=p.default.createRef(),n}return s(t,e),l(t,[{key:"getGrid",value:function(e,t){var n=this.state.grid,r=this.props.widthClass,i=n[e]||n[0];return void 0===e&&(i="col-md-12"===r?n[0]:n[1]),A(t,"col-12",i)}},{key:"getItems",value:function(e,t){return"edit"===this.props.mode&&(t.no_cache=!0),new Promise(function(n,r){g.default.get(e,{cancelToken:new q(function(e){E=e}),params:t}).then(function(e){n(e)}).catch(function(e){r(e)})})}},{key:"moreItem",value:function(){this.props.onAction({action:"click_new_item",data:{}})}},{key:"componentDidUpdate",value:function(e){e.tpl!==this.props.tpl&&this.cachedItems&&this.setState({items:this.transformItems(this.cachedItems)})}},{key:"componentDidMount",value:function(){this.loadItems(1,"init")}},{key:"loadItems",value:function(e,t){var n=this,r=this.blogModule&&this.blogModule.distant_id||this.props.idBlog,i=j+"/public/blogs/"+r+"/articles";this.props.categorie&&void 0!==this.props.categorie.id&&(i=j+"/public/categories/"+this.props.categorie.id+"/articles");var a={page:e};this.getItems(i,a).then(function(e){var r=e.data.items,i=e.data,a=i.numItems,o=i.page,s=i.totalItems;r=n.transformItems(r),n.setState({items:r,numItems:a,page:o,totalItems:s,inLoading:!1},function(){if("page_change"===t){var e=n.refArticles.current;if(e){var r=e.querySelector('[card-index="0"]');$("html, body").animate({scrollTop:$(r).offset().top-55},750)}}})}).catch(function(e){return console.log("erreur!!",e)})}},{key:"transformItems",value:function(e){this.cachedItems=e;var t=this.props,n=t.tpl;t.blocks;return e.map(function(e){var t=e.article_histories[0],r=t.src_set&&L(JSON.parse(t.src_set)),i={active:!0,class:"",link:"/blog/"+e.slug,txt:"Lire la suite",icon:"",target:"_self"};return c({},e,{title:{txt:e.title,class:"",visible:!0},txt:{txt:t.description,class:"",visible:!0},link:i,linkOnCard:c({},i,{active:!0}),item:{link:i,img:{path:t.image,css:"img-fluid"},tpl:"Card2"===n?"bgImgLink":"imgLink",visible:t.image&&"https://mediacache.epicred.fr/4X6DE68rOO9oeeAGN6wlzbLgPTU=/1920x/https://media.epicred.fr/media/cache/original/all/5c1901e87c038.png"!==t.image,srcSet:r}})})}},{key:"onActionPagination",value:function(e){var t=this;"page_change"===e.action&&this.setState({inLoading:!0},function(){t.loadItems(e.data.nextPage,e.action)})}},{key:"getOrder",value:function(e){var t={img:"left"},n={img:"right"};switch(this.props.orderCard){case 1:return t;case 2:return n;case 3:return e%2==0?t:n;case 4:return e%2==0?n:t;default:return t}}},{key:"render",value:function(){var e=this,t=this.props,n=t.blocks,r=t.bgCards,a=i(t,["blocks","bgCards"]),o=this.props,s=o.prefixCss,l=o.mode,u=o.msgAddItem,f=(o.widthClass,o.tpl),m=o.onManageModule,g=o.cardsInRow,h=o.mepOpts,v=o.mep,x=this.state,_=x.totalItems,w=x.numItems,I=x.forcePage,k=x.inLoading,P=I&&I-1||null,O=Math.ceil(_/w),C=n.find(function(e){return"title"===e.name})||{title:null},R=C.title,j=this.state.items;return p.default.createElement(d.default,c({title:R},a),k&&p.default.createElement("div",{className:"text-center"},p.default.createElement("i",{className:"fas fa-spinner fa-pulse"})),!k&&0==_&&p.default.createElement("div",{className:"text-center mx-auto my-5"},"Aucun article ne semble en ligne actuellement."),p.default.createElement("div",{style:"edit"===l&&{padding:"1rem"}||{},className:A("","edit"===l&&"we-overlay")},p.default.createElement("div",{ref:this.refArticles,"data-app-listing":!0,className:A("","row","justify-content-center")},j.map(function(t,n){var i=e.getOrder(n);return p.default.createElement("div",{key:n,"card-index":n,className:A(s,e.getGrid(g,s),"py-2")},p.default.createElement(y.default,{order:i,mode:"view",card:c({},t,{bg:r}),tpl:f,mep:v,prefixCss:s,mepOpts:h}))})),"edit"===l&&p.default.createElement("div",{style:{boxShadow:"0 0 5px #333",cursor:"pointer"},className:"we-overlay-body we-d-flex we-justify-content-center we-align-items-center",onClick:function(e){e.preventDefault(),e.stopPropagation(),m()}},p.default.createElement("button",{style:{zIndex:"1"},className:A("we-","btn","btn-dark","bg-dark"),onClick:function(e){e.preventDefault(),e.stopPropagation(),m()}},p.default.createElement("i",{className:"fas fa-pen-nib"})," ",u))),O>1&&p.default.createElement(b.default,{forcePage:P,pageCount:O,onAction:function(t){return e.onActionPagination(t)}}))}}]),t}(u.Component);M.defaultProps={prefixCss:"",mep:null,mode:"view",sectionCss:"",bg:{class:"bg-white",img:{path:"",class:""}},tpl:"Card2",widthClass:"col-md-12",orderCard:{img:"left"},onManageModule:function(){},blocks:[{name:"title",title:{txt:"BlogiBloga",class:"w-100"}},{name:"stitle",stitle:{txt:"Mon blog à moi",class:""}},{name:"card",pathItem:"",typeItem:""}],msgAddItem:"Gérer le blog",categorie:null,items:{items:[]}},t.default=M},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t){e.exports=i},function(e,t){e.exports=a},function(e,t){e.exports=o}])});