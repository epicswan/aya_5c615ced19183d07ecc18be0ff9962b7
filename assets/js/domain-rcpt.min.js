!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("UtilsRcpt"),require("SectionRcpt"),require("axios")):"function"==typeof define&&define.amd?define(["react","UtilsRcpt","SectionRcpt","axios"],t):"object"==typeof exports?exports.DomainRcpt=t(require("react"),require("UtilsRcpt"),require("SectionRcpt"),require("axios")):e.DomainRcpt=t(e.React,e.UtilsRcpt,e.SectionRcpt,e.axios)}("undefined"!=typeof self?self:this,function(e,t,n,r){return function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),a=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=a.default},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l,c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=n(2),f=r(d),m=n(3),p=r(m),h=n(4),g=r(h),v=n(5),_=r(v),y=n(6),b=p.default._store.getEnv(),x=b.scheme,E=b.domain,k=b.subdomain,C=b.apiProd,N=b.domainApi,S=C?N:E,w=C?k:"api",D=(x+"://"+w+"."+S+"/public/ndds/extensions").replace("__API__","platform"),A=(x+"://"+w+"."+S+"/public/ndds/transferables").replace("__API__","platform"),O=((x+"://"+w+"."+S+"/public/ndds/frees").replace("__API__","platform"),C?k:"shop"),V=(x+"://"+O+"."+(C?N:E)).replace("__API__","shop"),T=_.default.CancelToken,j=function(e){function t(e){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.domainCtrl={isValid:!1,isDirty:!1,rules:[{rule:function(e){return e&&e.length>=4},msg:"Veuillez renseigner au moins 4 caractères."},{rule:function(e){return e.length<=30},msg:"Veuillez renseigner au maximun 30 caractères."},{rule:function(e){return"-"!==e.slice(-1)},msg:"Le nom de domaine n'est pas valide."}]},n.tldsAuth=["fr","com","eu","be","name","it","uk","pm","re","tf","yt"],n.checkDomain=function(e){e.preventDefault();var t=n.state;t.domainVal,t.extensionVal;if(!n.domainCtrl.isValid)return void n.checkErrors();n.setState({is_searching:!0,domain_checked:!1},function(){n.checkExtensions()})},n.domainChanged=function(e){var t=n.string_to_slug(e.target.value);t=n.trimDash(t),n.setState({domain_checked:!1,domainVal:t,suggestedDomains:[]},function(){n.checkErrors()})},n.extensionChanged=function(e){var t=n.state,r=(t.domain_checked,t.msgsErrors);n.setState({extensionVal:e.target.value,msgsErrors:n.domainCtrl.isValid?[]:r},function(){n.setState({domain_free:n.isFree()})})},n.goInCreateMode=function(e){n.setState({domain_free:!1,domain_checked:!1,domainVal:"",extensionVal:"fr",suggestedDomains:[],msgsErrors:[],is_searching:!1,modeTransfer:!1,labelBtnSearch:"Rechercher",auth_key:""})},n.goInTransferMode=function(e){n.setState({domain_free:!1,domain_checked:!1,suggestedDomains:[],msgsErrors:[],is_searching:!1,isLoadedDetectorAction:!0,modeTransfer:!0,labelBtnSearch:"Vérifier"})},n.state={domain_free:!1,domain_checked:!1,domainVal:"",extensionVal:"fr",suggestedDomains:[],msgsErrors:[],is_searching:!1,isLoadedDetectorAction:!1,modeTransfer:!1,labelBtnSearch:"Rechercher",auth_key:"",cancelToken:null,forcePage:1,items:[],inLoading:!0,paramsUrl:{page:1}},n.shopModule=p.default._store.getUidSite("shop"),n}return s(t,e),u(t,[{key:"getItems",value:function(e,t){return new Promise(function(n,r){_.default.get(e,{cancelToken:new T(function(e){l=e}),params:t}).then(function(e){n(e)}).catch(function(e){r(e)})})}},{key:"loadItems",value:function(e,t){var n=this,r=this.shopModule&&this.shopModule.distant_id,a=V+"/public/produits/"+r+"/articles";this.props.categorie&&void 0!==this.props.categorie.id&&(a=V+"/public/categories/"+r+"/articles/"+this.props.categorie.id),this.getItems(a,e).then(function(t){var r=t.data.items,a=t.data,i=a.numItems,o=a.page,s=a.totalItems;n.setState({items:r,numItems:i,page:o,totalItems:s,inLoading:!1,paramsUrl:e},function(){n.detechActionDomain()})}).catch(function(e){return console.log("erreur!!",e)})}},{key:"checkExtensions",value:function(){var e=this,t=this.state,n=t.domainVal,r=t.modeTransfer,a=t.extensionVal,i=t.auth_key,o={domain_name:n};r?(o={domain_name:n+"."+a,auth_key:i},_.default.post(A,o).then(function(t){e.setState({is_searching:!1},function(){if(t.data.state){var n=e.state.items.find(function(e){return"Transfert domaine"===e.titre});if(!n)return void alert("Transfert de domaine non disponible");(0,y.createOrder)(n.id,"Transfert de",o.domain_name,n.prixHt,1,"ndd_transfer",i)}})},function(t){e.setState({is_searching:!1,msgsErrors:t.response.data.errors&&t.response.data.errors.map(function(e,t){return f.default.createElement("li",{key:t,className:"m-auto text-danger"},e)})||[]})})):_.default.post(D,o).then(function(t){e.setState({is_searching:!1,domain_checked:!0,suggestedDomains:t.data.data},function(){e.setState({domain_free:e.isFree()})})})}},{key:"isFree",value:function(){var e=this.state,t=e.domainVal,n=e.extensionVal,r=e.suggestedDomains,a=!1,i=t+"."+n;for(var o in r)r[o]===i&&(a=!0);return a}},{key:"checkErrors",value:function(){var e=this.state.domainVal;this.domainCtrl.isDirty=!0;for(var t=[],n=0;n<this.domainCtrl.rules.length;n++){var r=this.domainCtrl.rules[n];r.rule(e)||(t=[].concat(a(t),[f.default.createElement("li",{key:n,className:"m-auto text-danger"},r.msg)]))}this.domainCtrl.isValid=0===t.length,this.setState({msgsErrors:t})}},{key:"trimDash",value:function(e){if(e){var t=e.length;"-"===e.charAt(0)&&(e=e.slice(1,t))}return e}},{key:"string_to_slug",value:function(e){e=e.replace(/^\s+|\s+$/g,""),e=e.toLowerCase();for(var t="àáäâèéëêìíïîòóöôùúüûñç·/_,:;",n="aaaaeeeeiiiioooouuuunc------",r=0,a=t.length;r<a;r++)e=e.replace(new RegExp(t.charAt(r),"g"),n.charAt(r));return e=e.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}},{key:"componentDidMount",value:function(){this.loadItems({page:1},"init")}},{key:"detechActionDomain",value:function(){var e=this.getParamsUrl();if(e&&e.ndd_action)switch(e.ndd_action){case"ndd_renew":var t=this.state.items.find(function(e){return"Renouvellement domaine"===e.titre});if(!t)return void alert("Renouvellement de domaine non disponible");(0,y.createOrder)(t.id,"Renouvellement de",e.domain_name,t.prixHt,1,"ndd_renew");break;case"ndd_transfer":this.goInTransferMode()}else this.setState({isLoadedDetectorAction:!0})}},{key:"getParamsUrl",value:function(){if("string"!=typeof location.search||""===location.search)return null;var e={};return location.search.substr(1).split("&").map(function(t){var n=t.split("=");e[n[0]]=n[1]}),e}},{key:"render",value:function(){var e=this,t=this.state,n=t.domain_free,r=t.domain_checked,a=t.domainVal,i=t.extensionVal,o=t.suggestedDomains,s=t.is_searching,l=t.msgsErrors,u=t.modeTransfer,d=t.isLoadedDetectorAction,m=t.labelBtnSearch,p=t.auth_key,h=t.inLoading,v=this.props.blocks,_=v.find(function(e){return"title"===e.name})||{title:null},b=_.title;u&&b&&(b.txt='<h2 class="text-center">Transférer un nom de domaine sur Wifeo</h2>');var x="";if(this.domainCtrl.isDirty&&(x=this.domainCtrl.isValid?"is-valid":"is-invalid"),!d||h)return f.default.createElement(g.default,this.props,f.default.createElement("div",{className:"text-center"},f.default.createElement("i",{className:"fas fa-spinner fa-spin mr-1"})));var E="form-group form-inline justify-content-center";return f.default.createElement(g.default,c({title:b},this.props),f.default.createElement("div",null,!u&&f.default.createElement("div",{className:"text-center"},f.default.createElement("strong",null,"Enregistrez un nom de domaine personnalisé")),u&&f.default.createElement("div",{className:"text-center"},"Indiquer le nom de domaine ainsi que le code d'autorisation"),f.default.createElement("form",{autoComplete:"off",onSubmit:this.checkDomain},f.default.createElement("div",{className:E},f.default.createElement("div",null,f.default.createElement("strong",null,"https://www.")),f.default.createElement("input",{name:"domainWifeo",value:a,onChange:this.domainChanged,type:"text",minLength:"4",maxLength:"30",required:!0,className:"form-control "+x}),f.default.createElement("strong",null,"."),f.default.createElement("select",{onChange:this.extensionChanged,className:"form-control my-1 mr-sm-2",name:"domainExtension",id:"inlineFormCustomSelectPref",style:{padding:"2px",width:"70px"}},this.tldsAuth.map(function(e,t){return f.default.createElement("option",{key:t,value:e},e)})),!u&&f.default.createElement("button",{type:"submit",className:"btn btn-primary"},m)),u&&[f.default.createElement("div",{key:"0",className:E},f.default.createElement("input",{name:"domainWifeo",value:p,onChange:function(t){return e.setState({auth_key:t.target.value})},type:"text",maxLength:"100",required:!0,placeholder:"Code d'autorisation",className:"form-control"})),f.default.createElement("div",{key:"1",className:E},f.default.createElement("button",{type:"submit",className:"btn btn-primary"},m))]),l&&l.length>0&&f.default.createElement("ul",{style:{flexBasis:"100%",flexDirection:"column"},className:"d-flex text-center list-unstyled"},l),0==n&&1==r&&f.default.createElement("div",{className:"mt-2 alert alert-warning text-center"},f.default.createElement("div",null,"https://www.",a,".",i," est déjà pris.",f.default.createElement("br",null)," Voici d’autres noms de domains disponibles")),1==n&&1==r&&f.default.createElement("div",{className:"mt-2 alert alert-success text-center"},f.default.createElement("div",null,f.default.createElement("strong",null,"https://www.",a,".",i," est disponible."))),""!=a&&f.default.createElement("div",null,1==s&&f.default.createElement("div",{className:"col-12"},f.default.createElement("p",{className:"text-center"},f.default.createElement("i",{className:"fas fa-spinner fa-spin mr-1"}),"Chargement en cours")),0==s&&o.length>0&&f.default.createElement("div",{className:"card mx-auto",style:{maxWidth:"700px"}},f.default.createElement("div",{className:"card-body"},f.default.createElement("div",{className:"h5"},f.default.createElement("strong",null,"Que pensez-vous de ces suggestions ?")),o.map(function(t,n){return f.default.createElement("div",{key:n,className:"d-flex flex-row align-items-center py-2 px-2",style:{borderBottom:"solid 1px rgba(208, 196, 196, 0.22)"}},f.default.createElement("div",{className:"",style:{flexGrow:1}},t),f.default.createElement("div",{className:""},f.default.createElement("button",{className:"btn btn-outline-primary",style:{borderRadius:"20px"},onClick:function(){var n=e.state.items.find(function(e){return"Nouveau domaine"===e.titre});if(!n)return void alert("Creation de domaine non disponible");(0,y.createOrder)(n.id,"Création de",t,n.prixHt,"1","ndd_create")}},"Obtenir")))}))))),f.default.createElement("hr",null),u&&f.default.createElement("div",{className:"text-center"},f.default.createElement("button",{className:"btn btn-link py-0 pl-1",onClick:this.goInCreateMode},"Acheter un nom de domaine")),!u&&f.default.createElement("div",{className:"text-center"},"Vous possédez déjà un domaine ?"," ",f.default.createElement("button",{className:"btn btn-link py-0 pl-1",onClick:this.goInTransferMode},"Transférez-le sur wifeo")))}}]),t}(d.Component);j.defaultProps={mode:"view",blocks:[]},t.default=j},function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t,n){"use strict";function r(e,t){var n=parseFloat(e);return(Math.round(100*n)/100).toFixed(t)}function a(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function i(e,t,n,a,i,s,l){var c=(parseFloat(r(a,6)),[]),u=o(n),d={id:e,object:null,catalog_item:"formule",is_variation:!1,type:null,name:t+" "+n+" : 1 AN",quantity:1,sku:u,unit_costTtc:17.9,unit_costHt:17.9,totalTtc:17.9,totalHt:17.9,totalTtcBeforeDiscount:17.9,totalHtBeforeDiscount:17.9,totalDiscountHt:0,totalDiscountTtc:0,totalOptionsTtc:0,totalOptionsHt:0,totalTax:0,image_url:"https://mediacache.epicred.fr/U7NAK5C9ZjfWDuoCwr-xFHo2Otw=/1920x/https://media.epicred.fr/media/cache/original/all/5c8a6b89414db.jpeg",object_url:null,discountable:!1,discounts:[],taxable:null,formuleGroupe:'[{"id":12,"nom":"NDD"}]',taxes:[],metadata:[{domain_name:n,ndd_action:s,authkey:l}]};for(var f in c)"formule"==c[f].catalog_item&&c.splice(f,1);c.push(d),localStorage.setItem("cart_items",JSON.stringify(c)),location.href="/shop/panier"}function o(e){function t(e,t){return e<<t|e>>>32-t}function n(e,t){var n,r,a,i,o;return a=2147483648&e,i=2147483648&t,n=1073741824&e,r=1073741824&t,o=(1073741823&e)+(1073741823&t),n&r?2147483648^o^a^i:n|r?1073741824&o?3221225472^o^a^i:1073741824^o^a^i:o^a^i}function r(e,t,n){return e&t|~e&n}function a(e,t,n){return e&n|t&~n}function i(e,t,n){return e^t^n}function o(e,t,n){return t^(e|~n)}function s(e,a,i,o,s,l,c){return e=n(e,n(n(r(a,i,o),s),c)),n(t(e,l),a)}function l(e,r,i,o,s,l,c){return e=n(e,n(n(a(r,i,o),s),c)),n(t(e,l),r)}function c(e,r,a,o,s,l,c){return e=n(e,n(n(i(r,a,o),s),c)),n(t(e,l),r)}function u(e,r,a,i,s,l,c){return e=n(e,n(n(o(r,a,i),s),c)),n(t(e,l),r)}function d(e){var t,n,r="",a="";for(n=0;n<=3;n++)t=e>>>8*n&255,a="0"+t.toString(16),r+=a.substr(a.length-2,2);return r}var f,m,p,h,g,v,_,y,b,x=Array();for(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t}(e),x=function(e){for(var t,n=e.length,r=n+8,a=(r-r%64)/64,i=16*(a+1),o=Array(i-1),s=0,l=0;l<n;)t=(l-l%4)/4,s=l%4*8,o[t]=o[t]|e.charCodeAt(l)<<s,l++;return t=(l-l%4)/4,s=l%4*8,o[t]=o[t]|128<<s,o[i-2]=n<<3,o[i-1]=n>>>29,o}(e),v=1732584193,_=4023233417,y=2562383102,b=271733878,f=0;f<x.length;f+=16)m=v,p=_,h=y,g=b,v=s(v,_,y,b,x[f+0],7,3614090360),b=s(b,v,_,y,x[f+1],12,3905402710),y=s(y,b,v,_,x[f+2],17,606105819),_=s(_,y,b,v,x[f+3],22,3250441966),v=s(v,_,y,b,x[f+4],7,4118548399),b=s(b,v,_,y,x[f+5],12,1200080426),y=s(y,b,v,_,x[f+6],17,2821735955),_=s(_,y,b,v,x[f+7],22,4249261313),v=s(v,_,y,b,x[f+8],7,1770035416),b=s(b,v,_,y,x[f+9],12,2336552879),y=s(y,b,v,_,x[f+10],17,4294925233),_=s(_,y,b,v,x[f+11],22,2304563134),v=s(v,_,y,b,x[f+12],7,1804603682),b=s(b,v,_,y,x[f+13],12,4254626195),y=s(y,b,v,_,x[f+14],17,2792965006),_=s(_,y,b,v,x[f+15],22,1236535329),v=l(v,_,y,b,x[f+1],5,4129170786),b=l(b,v,_,y,x[f+6],9,3225465664),y=l(y,b,v,_,x[f+11],14,643717713),_=l(_,y,b,v,x[f+0],20,3921069994),v=l(v,_,y,b,x[f+5],5,3593408605),b=l(b,v,_,y,x[f+10],9,38016083),y=l(y,b,v,_,x[f+15],14,3634488961),_=l(_,y,b,v,x[f+4],20,3889429448),v=l(v,_,y,b,x[f+9],5,568446438),b=l(b,v,_,y,x[f+14],9,3275163606),y=l(y,b,v,_,x[f+3],14,4107603335),_=l(_,y,b,v,x[f+8],20,1163531501),v=l(v,_,y,b,x[f+13],5,2850285829),b=l(b,v,_,y,x[f+2],9,4243563512),y=l(y,b,v,_,x[f+7],14,1735328473),_=l(_,y,b,v,x[f+12],20,2368359562),v=c(v,_,y,b,x[f+5],4,4294588738),b=c(b,v,_,y,x[f+8],11,2272392833),y=c(y,b,v,_,x[f+11],16,1839030562),_=c(_,y,b,v,x[f+14],23,4259657740),v=c(v,_,y,b,x[f+1],4,2763975236),b=c(b,v,_,y,x[f+4],11,1272893353),y=c(y,b,v,_,x[f+7],16,4139469664),_=c(_,y,b,v,x[f+10],23,3200236656),v=c(v,_,y,b,x[f+13],4,681279174),b=c(b,v,_,y,x[f+0],11,3936430074),y=c(y,b,v,_,x[f+3],16,3572445317),_=c(_,y,b,v,x[f+6],23,76029189),v=c(v,_,y,b,x[f+9],4,3654602809),b=c(b,v,_,y,x[f+12],11,3873151461),y=c(y,b,v,_,x[f+15],16,530742520),_=c(_,y,b,v,x[f+2],23,3299628645),v=u(v,_,y,b,x[f+0],6,4096336452),b=u(b,v,_,y,x[f+7],10,1126891415),y=u(y,b,v,_,x[f+14],15,2878612391),_=u(_,y,b,v,x[f+5],21,4237533241),v=u(v,_,y,b,x[f+12],6,1700485571),b=u(b,v,_,y,x[f+3],10,2399980690),y=u(y,b,v,_,x[f+10],15,4293915773),_=u(_,y,b,v,x[f+1],21,2240044497),v=u(v,_,y,b,x[f+8],6,1873313359),b=u(b,v,_,y,x[f+15],10,4264355552),y=u(y,b,v,_,x[f+6],15,2734768916),_=u(_,y,b,v,x[f+13],21,1309151649),v=u(v,_,y,b,x[f+4],6,4149444226),b=u(b,v,_,y,x[f+11],10,3174756917),y=u(y,b,v,_,x[f+2],15,718787259),_=u(_,y,b,v,x[f+9],21,3951481745),v=n(v,m),_=n(_,p),y=n(y,h),b=n(b,g);return(d(v)+d(_)+d(y)+d(b)).toLowerCase()}Object.defineProperty(t,"__esModule",{value:!0}),t.arrondi=r,t.GUID=a,t.createOrder=i,t.md5=o}])});