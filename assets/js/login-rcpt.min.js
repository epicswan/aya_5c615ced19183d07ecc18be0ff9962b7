!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("JSONSchemaForm"),require("axios"),require("UtilsRcpt")):"function"==typeof define&&define.amd?define(["react","JSONSchemaForm","axios","UtilsRcpt"],t):"object"==typeof exports?exports.LoginRcpt=t(require("react"),require("JSONSchemaForm"),require("axios"),require("UtilsRcpt")):e.LoginRcpt=t(e.React,e.JSONSchemaForm,e.axios,e.UtilsRcpt)}(this,function(e,t,a,n){return function(e){function t(n){if(a[n])return a[n].exports;var o=a[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var a={};return t.m=e,t.c=a,t.p="/dist/",t(0)}([function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(1),r=n(o);t.default=r.default},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c,s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),d=a(2),m=n(d),u=a(3),p=(n(u),a(4)),f=n(p),h=a(5),b=(n(h),a(7)),y=n(b),g=a(8),v=(n(g),a(9)),E=(n(v),a(6)),_=n(E),S=(f.default.CancelToken,_.default._store.getEnv()),C=S.scheme,N=S.domain,w=S.subdomain,M=S.apiProd,k=S.domainApi,I=M?w:"form",O=(C+"://"+I+"."+(M?k:N)).replace("__API__","form"),T=function(e){function t(e){var a;r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.adminFrame=m.default.createRef(),n.state=(a={user_uid:n.props.user_uid,user_email:"",step:n.props.step,bearer:{},uid:n.props.uid,error:null},o(a,"bearer",{}),o(a,"isLoaded",!0),o(a,"pathGet",n.props.url),o(a,"pathSave",O+"/public/reponse/create/"),o(a,"cancelToken",null),a),n.onIdentificationSuccess=n.onIdentificationSuccess.bind(n),n.onIdentificationFail=n.onIdentificationFail.bind(n),n.parseJwt=n.parseJwt.bind(n),n}return l(t,e),s(t,[{key:"componentDidMount",value:function(){if("final"!=this.props.step){var e=JSON.parse(localStorage.getItem("cart_items"))?JSON.parse(localStorage.getItem("cart_items")):[];"undefined"!=typeof window.NavBarHeader&&(console.log("updating navbar"),window.NavBarHeader.setState({menuItemsCart:e})),this.setState({orderItems:e})}if(this.state.user_uid&&"final"!=this.state.step){var t=this.parseJwt(localStorage.getItem("currentUser"));t.username&&this.setState({user_uid:t.username,user_email:"addemailto@token.fr",step:2})}}},{key:"parseJwt",value:function(e){var t=e.split(".")[1],a=t.replace("-","+").replace("_","/");return JSON.parse(window.atob(a))}},{key:"onIdentificationSuccess",value:function(e){localStorage.setItem("currentUser",e.token);var t=JSON.stringify({token:e.token});this.adminFrame.current.contentWindow.postMessage(t,"*"),"undefined"!=typeof window.NavBarHeader&&(console.log("updating navbar"),window.NavBarHeader.setState({showLogin:!0}));var a=this.parseJwt(e.token);a.username&&(location.href=this.props.loginRedirect,this.setState({user_uid:a.username,user_email:e.email,step:2}))}},{key:"onIdentificationFail",value:function(e){alert("Identification impossible. Vérifier vos accès. "),console.log("login fail reponse",e)}},{key:"componentWillUnmount",value:function(){c&&"function"==typeof c&&c()}},{key:"render",value:function(){var e=this.state,t=(e.isLoaded,e.customer),a=e.uid,n=this.props,o=(n.prefixClass,n.sectionClassName),r=n.bg;n.blocks,n.mode,n.logo;return m.default.createElement("section",null,m.default.createElement("div",{className:"container-fluid col-12 "+r.class+" "+o},""!=r.img.path&&m.default.createElement("img",{src:r.img.path,className:r.img.class}),m.default.createElement("div",{className:"row"},m.default.createElement("div",{className:"container"},m.default.createElement("div",{className:"d-flex justify-content-center "},m.default.createElement("div",{className:"col-md-6"},m.default.createElement("iframe",{ref:this.adminFrame,height:"0px",id:"iframeContent",name:"content",frameBorder:"0",src:this.props.adminFrame}),m.default.createElement(y.default,{customer:t,onIdentificationSuccess:this.onIdentificationSuccess,onIdentificationFail:this.onIdentificationFail,uid:a})))))))}}]),t}(d.Component);T.defaultProps={prefixClass:"",loginRedirect:C+"://editor."+N+"/dashboard/",adminFrame:C+"://editor."+N+"/external_login.html",mode:"view",sectionClassName:"",bg:{class:"bg-white",img:{path:"",class:""}},show_title:!1,master_mode:!1,uid:"B14F8619-5B10-4D54-9B79-A503F7EB7DA7",user_uid:null,step:"final"},t.default=T},function(t,a){t.exports=e},function(e,a){e.exports=t},function(e,t){e.exports=a},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l,c=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(2),d=n(s),m=a(3),u=n(m),p=a(4),f=n(p),h=a(6),b=n(h),y=f.default.CancelToken,g=b.default._store.getEnv(),v=g.scheme,E=g.domain,_=g.subdomain,S=g.apiProd,C=g.domainApi,N=S?_:"membership",w=S?C:E,M=(v+"://"+N+"."+w).replace("__API__","membership"),k=S?_:"user",I=(v+"://"+k+"."+w).replace("__API__","user"),O=[{name:"Afghanistan",code:"AF"},{name:"Åland Islands",code:"AX"},{name:"Albania",code:"AL"},{name:"Algeria",code:"DZ"},{name:"American Samoa",code:"AS"},{name:"AndorrA",code:"AD"},{name:"Angola",code:"AO"},{name:"Anguilla",code:"AI"},{name:"Antarctica",code:"AQ"},{name:"Antigua and Barbuda",code:"AG"},{name:"Argentina",code:"AR"},{name:"Armenia",code:"AM"},{name:"Aruba",code:"AW"},{name:"Australia",code:"AU"},{name:"Austria",code:"AT"},{name:"Azerbaijan",code:"AZ"},{name:"Bahamas",code:"BS"},{name:"Bahrain",code:"BH"},{name:"Bangladesh",code:"BD"},{name:"Barbados",code:"BB"},{name:"Belarus",code:"BY"},{name:"Belgium",code:"BE"},{name:"Belize",code:"BZ"},{name:"Benin",code:"BJ"},{name:"Bermuda",code:"BM"},{name:"Bhutan",code:"BT"},{name:"Bolivia",code:"BO"},{name:"Bosnia and Herzegovina",code:"BA"},{name:"Botswana",code:"BW"},{name:"Bouvet Island",code:"BV"},{name:"Brazil",code:"BR"},{name:"British Indian Ocean Territory",code:"IO"},{name:"Brunei Darussalam",code:"BN"},{name:"Bulgaria",code:"BG"},{name:"Burkina Faso",code:"BF"},{name:"Burundi",code:"BI"},{name:"Cambodia",code:"KH"},{name:"Cameroon",code:"CM"},{name:"Canada",code:"CA"},{name:"Cape Verde",code:"CV"},{name:"Cayman Islands",code:"KY"},{name:"Central African Republic",code:"CF"},{name:"Chad",code:"TD"},{name:"Chile",code:"CL"},{name:"China",code:"CN"},{name:"Christmas Island",code:"CX"},{name:"Cocos (Keeling) Islands",code:"CC"},{name:"Colombia",code:"CO"},{name:"Comoros",code:"KM"},{name:"Congo",code:"CG"},{name:"Congo, The Democratic Republic of the",code:"CD"},{name:"Cook Islands",code:"CK"},{name:"Costa Rica",code:"CR"},{name:"Cote D'Ivoire",code:"CI"},{name:"Croatia",code:"HR"},{name:"Cuba",code:"CU"},{name:"Cyprus",code:"CY"},{name:"Czech Republic",code:"CZ"},{name:"Denmark",code:"DK"},{name:"Djibouti",code:"DJ"},{name:"Dominica",code:"DM"},{name:"Dominican Republic",code:"DO"},{name:"Ecuador",code:"EC"},{name:"Egypt",code:"EG"},{name:"El Salvador",code:"SV"},{name:"Equatorial Guinea",code:"GQ"},{name:"Eritrea",code:"ER"},{name:"Estonia",code:"EE"},{name:"Ethiopia",code:"ET"},{name:"Falkland Islands (Malvinas)",code:"FK"},{name:"Faroe Islands",code:"FO"},{name:"Fiji",code:"FJ"},{name:"Finland",code:"FI"},{name:"France",code:"FR"},{name:"French Guiana",code:"GF"},{name:"French Polynesia",code:"PF"},{name:"French Southern Territories",code:"TF"},{name:"Gabon",code:"GA"},{name:"Gambia",code:"GM"},{name:"Georgia",code:"GE"},{name:"Germany",code:"DE"},{name:"Ghana",code:"GH"},{name:"Gibraltar",code:"GI"},{name:"Greece",code:"GR"},{name:"Greenland",code:"GL"},{name:"Grenada",code:"GD"},{name:"Guadeloupe",code:"GP"},{name:"Guam",code:"GU"},{name:"Guatemala",code:"GT"},{name:"Guernsey",code:"GG"},{name:"Guinea",code:"GN"},{name:"Guinea-Bissau",code:"GW"},{name:"Guyana",code:"GY"},{name:"Haiti",code:"HT"},{name:"Heard Island and Mcdonald Islands",code:"HM"},{name:"Holy See (Vatican City State)",code:"VA"},{name:"Honduras",code:"HN"},{name:"Hong Kong",code:"HK"},{name:"Hungary",code:"HU"},{name:"Iceland",code:"IS"},{name:"India",code:"IN"},{name:"Indonesia",code:"ID"},{name:"Iran, Islamic Republic Of",code:"IR"},{name:"Iraq",code:"IQ"},{name:"Ireland",code:"IE"},{name:"Isle of Man",code:"IM"},{name:"Israel",code:"IL"},{name:"Italy",code:"IT"},{name:"Jamaica",code:"JM"},{name:"Japan",code:"JP"},{name:"Jersey",code:"JE"},{name:"Jordan",code:"JO"},{name:"Kazakhstan",code:"KZ"},{name:"Kenya",code:"KE"},{name:"Kiribati",code:"KI"},{name:"Korea, Democratic People'S Republic of",code:"KP"},{name:"Korea, Republic of",code:"KR"},{name:"Kuwait",code:"KW"},{name:"Kyrgyzstan",code:"KG"},{name:"Lao People'S Democratic Republic",code:"LA"},{name:"Latvia",code:"LV"},{name:"Lebanon",code:"LB"},{name:"Lesotho",code:"LS"},{name:"Liberia",code:"LR"},{name:"Libyan Arab Jamahiriya",code:"LY"},{name:"Liechtenstein",code:"LI"},{name:"Lithuania",code:"LT"},{name:"Luxembourg",code:"LU"},{name:"Macao",code:"MO"},{name:"Macedonia, The Former Yugoslav Republic of",code:"MK"},{name:"Madagascar",code:"MG"},{name:"Malawi",code:"MW"},{name:"Malaysia",code:"MY"},{name:"Maldives",code:"MV"},{name:"Mali",code:"ML"},{name:"Malta",code:"MT"},{name:"Marshall Islands",code:"MH"},{name:"Martinique",code:"MQ"},{name:"Mauritania",code:"MR"},{name:"Mauritius",code:"MU"},{name:"Mayotte",code:"YT"},{name:"Mexico",code:"MX"},{name:"Micronesia, Federated States of",code:"FM"},{name:"Moldova, Republic of",code:"MD"},{name:"Monaco",code:"MC"},{name:"Mongolia",code:"MN"},{name:"Montserrat",code:"MS"},{name:"Morocco",code:"MA"},{name:"Mozambique",code:"MZ"},{name:"Myanmar",code:"MM"},{name:"Namibia",code:"NA"},{name:"Nauru",code:"NR"},{name:"Nepal",code:"NP"},{name:"Netherlands",code:"NL"},{name:"Netherlands Antilles",code:"AN"},{name:"New Caledonia",code:"NC"},{name:"New Zealand",code:"NZ"},{name:"Nicaragua",code:"NI"},{name:"Niger",code:"NE"},{name:"Nigeria",code:"NG"},{name:"Niue",code:"NU"},{name:"Norfolk Island",code:"NF"},{name:"Northern Mariana Islands",code:"MP"},{name:"Norway",code:"NO"},{name:"Oman",code:"OM"},{name:"Pakistan",code:"PK"},{name:"Palau",code:"PW"},{name:"Palestinian Territory, Occupied",code:"PS"},{name:"Panama",code:"PA"},{name:"Papua New Guinea",code:"PG"},{name:"Paraguay",code:"PY"},{name:"Peru",code:"PE"},{name:"Philippines",code:"PH"},{name:"Pitcairn",code:"PN"},{name:"Poland",code:"PL"},{name:"Portugal",code:"PT"},{name:"Puerto Rico",code:"PR"},{name:"Qatar",code:"QA"},{name:"Reunion",code:"RE"},{name:"Romania",code:"RO"},{name:"Russian Federation",code:"RU"},{name:"RWANDA",code:"RW"},{name:"Saint Helena",code:"SH"},{name:"Saint Kitts and Nevis",code:"KN"},{name:"Saint Lucia",code:"LC"},{name:"Saint Pierre and Miquelon",code:"PM"},{name:"Saint Vincent and the Grenadines",code:"VC"},{name:"Samoa",code:"WS"},{name:"San Marino",code:"SM"},{name:"Sao Tome and Principe",code:"ST"},{name:"Saudi Arabia",code:"SA"},{name:"Senegal",code:"SN"},{name:"Serbia and Montenegro",code:"CS"},{name:"Seychelles",code:"SC"},{name:"Sierra Leone",code:"SL"},{name:"Singapore",code:"SG"},{name:"Slovakia",code:"SK"},{name:"Slovenia",code:"SI"},{name:"Solomon Islands",code:"SB"},{name:"Somalia",code:"SO"},{name:"South Africa",code:"ZA"},{name:"South Georgia and the South Sandwich Islands",code:"GS"},{name:"Spain",code:"ES"},{name:"Sri Lanka",code:"LK"},{name:"Sudan",code:"SD"},{name:"Suriname",code:"SR"},{name:"Svalbard and Jan Mayen",code:"SJ"},{name:"Swaziland",code:"SZ"},{name:"Sweden",code:"SE"},{name:"Switzerland",code:"CH"},{name:"Syrian Arab Republic",code:"SY"},{name:"Taiwan, Province of China",code:"TW"},{name:"Tajikistan",code:"TJ"},{name:"Tanzania, United Republic of",code:"TZ"},{name:"Thailand",code:"TH"},{name:"Timor-Leste",code:"TL"},{name:"Togo",code:"TG"},{name:"Tokelau",code:"TK"},{name:"Tonga",code:"TO"},{name:"Trinidad and Tobago",code:"TT"},{name:"Tunisia",code:"TN"},{name:"Turkey",code:"TR"},{name:"Turkmenistan",code:"TM"},{name:"Turks and Caicos Islands",code:"TC"},{name:"Tuvalu",code:"TV"},{name:"Uganda",code:"UG"},{name:"Ukraine",code:"UA"},{name:"United Arab Emirates",code:"AE"},{name:"United Kingdom",code:"GB"},{name:"United States",code:"US"},{name:"United States Minor Outlying Islands",code:"UM"},{name:"Uruguay",code:"UY"},{name:"Uzbekistan",code:"UZ"},{name:"Vanuatu",code:"VU"},{name:"Venezuela",code:"VE"},{name:"Viet Nam",code:"VN"},{name:"Virgin Islands, British",code:"VG"},{name:"Virgin Islands, U.S.",code:"VI"},{name:"Wallis and Futuna",code:"WF"},{name:"Western Sahara",code:"EH"},{name:"Yemen",code:"YE"},{name:"Zambia",code:"ZM"},{name:"Zimbabwe",code:"ZW"}],T=function(e){return console.log.bind(console,e)},P=[],F=[],L=[],A=[],R=[],D=[],B=function(e){function t(e){o(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));for(var n in O){var i=O[n].code,l=O[n].name;F.push(l),P.push(i),A.push(l),L.push(i+"1"),D.push(l),R.push(i+"2")}return a.state={schema1:a.props.particulierForm.schema,schema2:a.props.entrepriseForm.schema,schema3:a.props.associationForm.schema,mesAddresses:[],mode:"facturation",formData:{},isCompany:1,isMr:!1,companyForm:!1,pathSaveRegister:M+"/register_"},a.doRegisterValidation=a.doRegisterValidation.bind(a),a.prefillData=a.prefillData.bind(a),a.formChanged=a.formChanged.bind(a),a}return i(t,e),c(t,[{key:"fetchForm",value:function(){var e=this,t=localStorage.getItem("currentUser")?localStorage.getItem("currentUser"):"";f.default.defaults.headers.common.Authorization="Bearer "+t,f.default.get(I+"/api/addresss/me",{cancelToken:new y(function(e){l=e})}).then(function(t){console.log("result axios :",t),e.setState({mesAddresses:t.data})})}},{key:"componentDidMount",value:function(){this.fetchForm()}},{key:"CustomFieldTemplate",value:function(e){var t=e.id,a=e.classNames,n=e.label,o=e.help,r=e.required,i=e.description,l=(e.errors,e.children);e.displayLabel;return d.default.createElement("div",{className:a},d.default.createElement("label",{htmlFor:t},n,r?"*":null),i,l,o)}},{key:"doRegisterValidation",value:function(e,t){this.validate(e,this.state.pathSaveRegister)}},{key:"formChanged",value:function(e,t){this.refs[t].className="was-validated"}},{key:"validate",value:function(e,t){this.props.onFacturationSuccess(e.formData)}},{key:"onCompanyClick",value:function(e){this.setState({isCompany:e})}},{key:"onMrClick",value:function(e){this.setState({isMr:e})}},{key:"prefillData",value:function e(t){var a=t.target.value,e={};for(var n in this.state.mesAddresses)this.state.mesAddresses[n].id==a&&(e=this.state.mesAddresses[n]);console.log("prefill Form with Data :",e),this.setState({formData:JSON.parse(JSON.stringify(e))})}},{key:"render",value:function(){var e=this,t=this.state,a=(t.schema2Validate,t.schema1Validate,t.schema3Validate,t.schema2),n=t.schema1,o=t.schema3,r=(t.companyForm,t.isCompany),i=t.isMr,l=t.formData,c=t.mesAddresses,s=this.doRegisterValidation,m=(this.flipMode,this.CustomFieldTemplate);return console.log("render..."),d.default.createElement("div",{className:"col-md-12"},c.length>0&&d.default.createElement("div",{className:"form-group"},d.default.createElement("select",{id:"disabledSelect",className:"form-control",onChange:this.prefillData},d.default.createElement("option",{value:""},"Séléctionner une adresse enregistrée"),c.map(function(e,t){return d.default.createElement("option",{key:t,value:e.id},e.address)}))),d.default.createElement("div",{className:"btn-group col-md-12 ",role:"group","aria-label":"First group",style:{padding:"0px"}},d.default.createElement("button",{type:"button",onClick:function(){return e.onCompanyClick(1)},className:"col-md-6 btn btn-outline-primary "+(1==r?"active":"")},"Particulier"),d.default.createElement("button",{type:"button",onClick:function(){return e.onCompanyClick(2)},className:"col-md-6  btn btn-outline-primary "+(2==r?"active":"")},"Entreprise"),d.default.createElement("button",{type:"button",onClick:function(){return e.onCompanyClick(3)},className:"col-md-6  btn btn-outline-primary "+(3==r?"active":"")},"Association")),d.default.createElement("br",null),d.default.createElement("br",null),1==r&&d.default.createElement("div",{className:"btn-group col-md-12",role:"group","aria-label":"First group",style:{padding:"0px"}},d.default.createElement("button",{type:"button",onClick:function(){return e.onMrClick(!1)},className:"col-md-6 btn btn-outline-primary "+(i?"":"active")},"Mr"),d.default.createElement("button",{type:"button",onClick:function(){return e.onMrClick(!0)},className:"col-md-6  btn btn-outline-primary "+(i?"active":"")},"Mme")),1==r&&d.default.createElement("div",{ref:"form1"},d.default.createElement(u.default,{schema:n,onChange:function(t){return e.formChanged(t,"form1")},FieldTemplate:m,formData:l,onError:T("errors"),onSubmit:s,showErrorList:!1,liveValidate:!0},d.default.createElement("div",{className:"text-right"},d.default.createElement("button",{className:"btn btn-primary",type:"submit"},"Continuer")))),2==r&&d.default.createElement("div",{ref:"form2"},d.default.createElement(u.default,{schema:a,onChange:function(t){return e.formChanged(t,"form2")},FieldTemplate:m,formData:l,onError:T("errors"),onSubmit:s,showErrorList:!1,liveValidate:!0},d.default.createElement("div",{className:"text-right"},d.default.createElement("button",{className:"btn btn-primary",type:"submit"},"Continuer")))),3==r&&d.default.createElement("div",{ref:"form3"},d.default.createElement(u.default,{schema:o,onChange:function(t){return e.formChanged(t,"form3")},FieldTemplate:m,formData:l,onError:T("errors"),onSubmit:s,showErrorList:!1,liveValidate:!0},d.default.createElement("div",{className:"text-right"},d.default.createElement("button",{className:"btn btn-primary",type:"submit"},"Continuer")))))}}]),t}(s.Component);B.defaultProps={prefixClass:"",mode:"view",sectionClassName:"",bg:{class:"bg-white",img:{path:"",class:""}},master_mode:!1,particulierForm:{type:"login",schema:{title:"",description:"",type:"object",required:["name","firstname","address","postal_code","town","telephone","country","birth_date","birth_postal_code","birth_town","birth_country"],properties:{name:{type:"string",title:"Nom",minLength:3},firstname:{type:"string",title:"Prénom",minLength:3},birth_date:{type:"string",title:"Date de naissance",format:"date"},birth_postal_code:{type:"string",title:"Code Postal du lieu de naissance",minLength:5},birth_town:{type:"string",title:"Ville du lieu de naissance",minLength:3},birth_country:{title:"Pays du lieu de naissance",type:"string",enum:P,enumNames:F},address:{type:"string",title:"Adresse",minLength:8},address2:{type:"string",title:"Suite de l'adresse",minLength:0},postal_code:{type:"string",title:"Code Postal",minLength:5},town:{type:"string",title:"Ville",minLength:3},telephone:{type:"string",title:"Téléphone",minLength:10},country:{title:"Pays",type:"string",enum:P,enumNames:F}}}},entrepriseForm:{type:"register",schema:{title:"",description:"",type:"object",required:["company_name","siret","tvaIntra","address","postal_code","town","telephone","country"],properties:{company_name:{type:"string",title:"Nom de l'entreprise",minLength:3,default:""},siret:{type:"string",title:"Siret de la société",minLength:3},tvaIntra:{type:"string",title:"Numéro de TVA Intracommunautaire",minLength:3},address:{type:"string",title:"Adresse",minLength:8},address2:{type:"string",title:"Suite de l'adresse",minLength:0},postal_code:{type:"string",title:"Code Postal",minLength:5},town:{type:"string",title:"Ville",minLength:3},telephone:{type:"string",title:"Téléphone",minLength:10},country:{title:"Pays",type:"string",enum:L,enumNames:A}}}},associationForm:{type:"register",schema:{title:"",description:"",type:"object",required:["company_name","siret","tvaIntra","address","postal_code","town","telephone","country","association_date","association_page"],properties:{company_name:{type:"string",title:"Nom de l'association",minLength:3,default:""},association_date:{type:"string",title:"Date de publication au journal officiel",format:"date"},association_page:{type:"string",title:"Numéro de page de la publication au journal officiel"},address:{type:"string",title:"Adresse",minLength:8},address2:{type:"string",title:"Suite de l'adresse",minLength:0},postal_code:{type:"string",title:"Code Postal",minLength:5},town:{type:"string",title:"Ville",minLength:3},telephone:{type:"string",title:"Téléphone",minLength:10},country:{title:"Pays",type:"string",enum:R,enumNames:D}}}}},t.default=B},function(e,t){e.exports=n},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l,c=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(2),d=n(s),m=a(3),u=n(m),p=a(4),f=n(p),h=a(6),b=n(h),y=(f.default.CancelToken,b.default._store.getEnv()),g=y.scheme,v=y.domain,E=y.subdomain,_=y.apiProd,S=y.domainApi,C=_?E:"user",N=(g+"://"+C+"."+(_?S:v)).replace("__API__","user"),w=function(e){return console.log.bind(console,e)},M=function(e){function t(e){o(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={schema1:a.props.loginForm.schema,schema2:a.props.registerForm.schema,uid:a.props.uid,loginForm:!1,error:null,bearer:{},isLoaded:!1,pathSaveLogin:N+"/login_check",pathSaveRegister:N+"/register",cancelToken:null},a.doLoginValidation=a.doLoginValidation.bind(a),a.doRegisterValidation=a.doRegisterValidation.bind(a),a.flipMode=a.flipMode.bind(a),a}return i(t,e),c(t,[{key:"doRegisterValidation",value:function(e,t){this.validate(e,this.state.pathSaveRegister)}},{key:"doLoginValidation",value:function(e){this.validate(e,this.state.pathSaveLogin)}},{key:"CustomFieldTemplate",value:function(e){var t=e.id,a=e.classNames,n=e.label,o=e.help,r=e.required,i=e.description,l=(e.errors,e.children);return d.default.createElement("div",{className:a},d.default.createElement("label",{htmlFor:t},n,r?"*":null),i,l,o)}},{key:"validate",value:function(e,t){var a={data:e.formData};a={_username:e.formData.email,_password:e.formData.password,_uid:this.props.uid};var n=this;f.default.post(t,a,{headers:{"Content-Type":"application/json"}}).then(function(e){n.props.onIdentificationSuccess({token:e.data.token,email:a._username})}).catch(function(e){n.props.onIdentificationFail(e)})}},{key:"flipMode",value:function(){this.setState({loginForm:!this.state.loginForm})}},{key:"componentDidMount",value:function(){this.state.pathGet}},{key:"componentWillUnmount",value:function(){l&&"function"==typeof l&&l()}},{key:"render",value:function(){var e=this.props,t=(e.prefixClass,e.sectionClassName),a=e.bg,n=(e.blocks,e.mode,e.uiSchema),o=this.state,r=o.schema2,i=o.schema1,l=o.loginForm,c=this.doLoginValidation,s=this.doRegisterValidation,m=this.CustomFieldTemplate;return d.default.createElement("section",null,d.default.createElement("div",{className:"container-fluid col-12 "+a.class+" "+t},""!=a.img.path&&d.default.createElement("img",{src:a.img.path,className:a.img.class}),d.default.createElement("div",{className:"row"},d.default.createElement("div",{className:"container my-7"},!l&&d.default.createElement(u.default,{schema:r,FieldTemplate:m,onError:w("errors"),onSubmit:c,showErrorList:!1,liveValidate:!0,uiSchema:n},d.default.createElement("div",{className:"text-right"},d.default.createElement("button",{type:"button",className:"btn btn-link",onClick:this.flipMode},"M'inscrire"),d.default.createElement("button",{className:"btn btn-primary",type:"submit"},"Continuer"))),l&&d.default.createElement(u.default,{schema:i,FieldTemplate:m,onError:w("errors"),onSubmit:s,showErrorList:!1,liveValidate:!0,uiSchema:n},d.default.createElement("div",{className:"text-right"},d.default.createElement("button",{type:"button",className:"btn btn-link",onClick:this.flipMode},"J'ai déjà un compte"),d.default.createElement("button",{className:"btn btn-primary",type:"submit"},"M'inscrire et Continuer")))))))}}]),t}(s.Component);M.defaultProps={prefixClass:"",mode:"view",sectionClassName:"",bg:{class:"bg-white",img:{path:"",class:""}},master_mode:!1,loginForm:{type:"login",schema:{title:"",description:"",type:"object",required:["email","password"],properties:{email:{type:"string",format:"email",title:"Email"},password:{type:"string",title:"Mot de Passe",minLength:5}}}},registerForm:{type:"register",schema:{title:"",description:"",type:"object",required:["email","password"],properties:{email:{type:"string",format:"email",title:"Email"},password:{type:"string",title:"Mot de Passe",minLength:5}}}},uiSchema:{password:{"ui:widget":"password"}}},t.default=M},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),c=a(2),s=n(c),d=function(e){function t(e){o(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={orderItems:a.props.orderItems,discounts:a.props.discounts,currency:"$",total:a.props.total,subtotal:a.props.subtotal},a.renderDeliveryOrOptions=a.renderDeliveryOrOptions.bind(a),a.recapCommandeDiscount=a.recapCommandeDiscount.bind(a),a}return i(t,e),l(t,[{key:"arrondi2c",value:function(e){return parseFloat(Math.round(100*parseFloat(e))/100).toFixed(2)+""+this.state.currency}},{key:"arrondi2ch",value:function(e){return parseFloat(Math.round(100*parseFloat(e))/100).toFixed(2)}},{key:"renderDeliveryOrOptions",value:function(e,t){return s.default.createElement("tr",{key:t},s.default.createElement("td",{scope:"row"},s.default.createElement("b",null,e.name),s.default.createElement("br",null),s.default.createElement("div",{dangerouslySetInnerHTML:{__html:e.description}})),s.default.createElement("td",{className:"text-right"}," ",this.arrondi2c(e.totalTtc)))}},{key:"recapCommandeDiscount",value:function(e,t){var a=1==e.is_percent?"%":this.state.currency;return s.default.createElement("tr",{key:t},s.default.createElement("td",{scope:"row"},s.default.createElement("b",null,"CODE DE REDUCTION: "),s.default.createElement("br",null)," ",e.coupon),s.default.createElement("td",{className:"text-right"}," - ",e.value," ",a))}},{key:"removeItemCart",value:function(e){this.props.removeItem(e),console.log("TODO multi produit"),localStorage.removeItem("cart_items"),"undefined"!=typeof window.NavBarHeader&&(console.log("updating navbar"),window.NavBarHeader.setState({menuItemsCart:[]}))}},{key:"recapCommandeProd",value:function(e,t){var a=this,n=e.discountable===!0?"<del>"+this.arrondi2c(e.totalTtcBeforeDiscount)+"</del>":"",o="";return e.metadata,s.default.createElement("tr",{key:t},s.default.createElement("td",{scope:"row"},s.default.createElement("span",{className:"badge badge-secondary"},e.quantity)),s.default.createElement("td",null,s.default.createElement("b",null," ",e.name),s.default.createElement("br",null),e.description,"  ",o),s.default.createElement("td",{dangerouslySetInnerHTML:{__html:n}}),s.default.createElement("td",{className:"text-right"},this.arrondi2c(e.totalTtc)),this.props.canRemove&&s.default.createElement("td",null,s.default.createElement("i",{className:"fas fa-trash-alt",onClick:function(){return a.removeItemCart(e.id)}})))}},{key:"render",value:function(){var e=this,t=this.props,a=t.orderItems,n=t.discounts,o=t.subtotal,r=t.total;return s.default.createElement("div",null,s.default.createElement("table",{className:"table"},s.default.createElement("tbody",{className:"results_panier"},a.filter(function(e){var t=e.catalog_item;return"product"===t}).map(function(t,a){return e.recapCommandeProd(t,a)}),a.filter(function(e){var t=e.catalog_item;return"delivery"===t}).map(function(t,a){return e.renderDeliveryOrOptions(t)}))),s.default.createElement("table",{className:"table"},s.default.createElement("thead",null,s.default.createElement("tr",null,s.default.createElement("th",null," SOUS TOTAL :"),s.default.createElement("th",{className:"subtotal text-right"},this.arrondi2c(o)))),s.default.createElement("tbody",{className:"after_sstotal"},a.filter(function(e){var t=e.catalog_item;return"cart-option"===t}).map(function(t,a){return e.renderDeliveryOrOptions(t,a)}),n.map(function(t,a){return e.recapCommandeDiscount(t,a)}))),s.default.createElement("table",{className:"table"},s.default.createElement("thead",null,s.default.createElement("tr",null,s.default.createElement("th",{style:{border:"none"}},"TOTAL :"),s.default.createElement("th",{style:{border:"none"},className:"total text-right"},this.arrondi2c(r))))))}}]),t}(c.Component);t.default=d},function(e,t,a){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);
e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l,c=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=a(2),d=n(s),m=a(4),u=n(m),p=a(6),f=n(p),h=u.default.CancelToken,b=(u.default.defaults.headers.common.Authorization,f.default._store.getEnv()),y=b.scheme,g=b.domain,v=b.subdomain,E=b.apiProd,_=b.domainApi,S=E?v:"paiement",C=(y+"://"+S+"."+(E?_:g)).replace("__API__","paiement"),N=function(e){function t(e){o(this,t);var a=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={title:"Mode de Paiement",items:[],selected_item:0,isLoaded:!1,Bearer:"",pathGetItems:C+"/magasins/1/moyens"},a}return i(t,e),c(t,[{key:"fetchForm",value:function(){var e=this;u.default.get(this.state.pathGetItems,{cancelToken:new h(function(e){l=e})}).then(function(t){e.props.onSelected(t.data[0]),e.setState({isLoaded:!0,items:t.data})})}},{key:"componentDidMount",value:function(){this.state.pathGetItems&&this.fetchForm()}},{key:"onChangeItem",value:function(e){this.setState({selected_item:e})}},{key:"itemSelection",value:function(e){this.setState({selected_item:e}),this.props.onSelected(this.state.items[e])}},{key:"doNothing",value:function(){}},{key:"render",value:function(){var e=this,t=this.state,a=t.items,n=(t.title,t.selected_item),o=t.isLoaded;return d.default.createElement("div",{className:"col-md-12"},!o&&d.default.createElement("div",{className:"panier_loader"},d.default.createElement("div",{align:"center"},d.default.createElement("i",{className:"fa fa-spinner fa-pulse fa-3x fa-fw"}),d.default.createElement("span",{className:"sr-only"},"Loading..."))),o&&d.default.createElement("ul",{className:"list-group"},a.map(function(t,a){return d.default.createElement("li",{key:a,className:"list-group-item",onClick:function(){return e.itemSelection(a)},style:{cursor:"pointer",border:n===a?"2px solid lightblue":"1px solid lightgrey"}},d.default.createElement("div",{className:"form-check-inline"},d.default.createElement("label",{className:"form-check-label"},d.default.createElement("input",{type:"radio",className:"form-check-input",value:a,onChange:e.doNothing,checked:n===a,name:"optradio"}),e.props.optionsFormatting(t))))})))}}]),t}(s.Component);t.default=N}])});