!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("moment"),require("DraftEditorRcpt"),require("MediaElementRcpt"),require("UtilsRcpt"),require("axios")):"function"==typeof define&&define.amd?define(["react","moment","DraftEditorRcpt","MediaElementRcpt","UtilsRcpt","axios"],t):"object"==typeof exports?exports.FactureRcpt=t(require("react"),require("moment"),require("DraftEditorRcpt"),require("MediaElementRcpt"),require("UtilsRcpt"),require("axios")):e.FactureRcpt=t(e.React,e.moment,e.DraftEditorRcpt,e.MediaElementRcpt,e.UtilsRcpt,e.axios)}("undefined"!=typeof self?self:this,function(e,t,o,n,a,l){return function(e){function t(n){if(o[n])return o[n].exports;var a=o[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var o={};return t.m=e,t.c=o,t.d=function(e,o,n){t.o(e,o)||Object.defineProperty(e,o,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(o,"a",o),o},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=3)}([function(t,o){t.exports=e},function(e,t,o){"use strict";function n(e){var t=l.find(function(t){return t.codeIso===e});return t?t.nom:""}function a(e,t){if(void 0!==e&&null!==e){var o=0==t?6:2;return parseFloat(e).toFixed(o)}}Object.defineProperty(t,"__esModule",{value:!0}),t.getCountryName=n,t.formatPrice=a;var l=[{codeIso:"DE",nom:"Allemagne"},{codeIso:"AT",nom:"Autriche"},{codeIso:"BE",nom:"Belgique"},{codeIso:"CA",nom:"Canada"},{codeIso:"CN",nom:"Chine"},{codeIso:"ES",nom:"Espagne"},{codeIso:"FI",nom:"Finlande"},{codeIso:"FR",nom:"France (Hors DOM TOM)"},{codeIso:"GR",nom:"Grèce"},{codeIso:"IT",nom:"Italie"},{codeIso:"JP",nom:"Japon"},{codeIso:"LU",nom:"Luxembourg"},{codeIso:"NL",nom:"Pays-bas"},{codeIso:"PL",nom:"Pologne"},{codeIso:"PT",nom:"Portugal"},{codeIso:"CZ",nom:"République Tchèque"},{codeIso:"GB",nom:"Royaume-Uni"},{codeIso:"SE",nom:"Suède"},{codeIso:"CH",nom:"Suisse"},{codeIso:"DK",nom:"Danemark"},{codeIso:"US",nom:"Etats-Unis"},{codeIso:"HK",nom:"Hong-Kong"},{codeIso:"NO",nom:"Norvège"},{codeIso:"AU",nom:"Australie"},{codeIso:"SG",nom:"Singapour"},{codeIso:"IE",nom:"Irlande"},{codeIso:"NZ",nom:"Nouvelle-Zélande"},{codeIso:"KR",nom:"Corée du Sud"},{codeIso:"IL",nom:"Israel"},{codeIso:"ZA",nom:"Afrique du Sud"},{codeIso:"NG",nom:"Nigeria"},{codeIso:"CI",nom:"CÃ´te d'Ivoire"},{codeIso:"TG",nom:"Togo"},{codeIso:"BO",nom:"Bolivie"},{codeIso:"MU",nom:"Ile Maurice"},{codeIso:"RO",nom:"Roumanie"},{codeIso:"SK",nom:"Slovaquie"},{codeIso:"DZ",nom:"AlgÃ©rie"},{codeIso:"AS",nom:"Samoa AmÃ©ricaines"},{codeIso:"AD",nom:"Andorre"},{codeIso:"AO",nom:"Angola"},{codeIso:"AI",nom:"Anguilla"},{codeIso:"AG",nom:"Antigua et Barbuda"},{codeIso:"AR",nom:"Argentine"},{codeIso:"AM",nom:"ArmÃ©nie"},{codeIso:"AW",nom:"Aruba"},{codeIso:"AZ",nom:"AzerbaÃ¯djan"},{codeIso:"BS",nom:"Bahamas"},{codeIso:"BH",nom:"BahreÃ¯n"},{codeIso:"BD",nom:"Bangladesh"},{codeIso:"BB",nom:"Barbade"},{codeIso:"BY",nom:"BÃ©larus"},{codeIso:"BZ",nom:"Belize"},{codeIso:"BJ",nom:"BÃ©nin"},{codeIso:"BM",nom:"Bermudes"},{codeIso:"BT",nom:"Bhoutan"},{codeIso:"BW",nom:"Botswana"},{codeIso:"BR",nom:"BrÃ©sil"},{codeIso:"BN",nom:"BrunÃ©i Darussalam"},{codeIso:"BF",nom:"Burkina Faso"},{codeIso:"MM",nom:"Burma (Myanmar)"},{codeIso:"BI",nom:"Burundi"},{codeIso:"KH",nom:"Cambodge"},{codeIso:"CM",nom:"Cameroun"},{codeIso:"CV",nom:"Cap-Vert"},{codeIso:"CF",nom:"Centrafricaine, RÃ©publique"},{codeIso:"TD",nom:"Tchad"},{codeIso:"CL",nom:"Chili"},{codeIso:"CO",nom:"Colombie"},{codeIso:"KM",nom:"Comores"},{codeIso:"CD",nom:"Congo, RÃ©p. DÃ©m."},{codeIso:"CG",nom:"Congo, RÃ©p."},{codeIso:"CR",nom:"Costa Rica"},{codeIso:"HR",nom:"Croatie"},{codeIso:"CU",nom:"Cuba"},{codeIso:"CY",nom:"Chypre"},{codeIso:"DJ",nom:"Djibouti"},{codeIso:"DM",nom:"Dominica"},{codeIso:"DO",nom:"RÃ©publique Dominicaine"},{codeIso:"TL",nom:"Timor oriental"},{codeIso:"EC",nom:"Ã‰quateur"},{codeIso:"EG",nom:"Ã‰gypte"},{codeIso:"SV",nom:"El Salvador"},{codeIso:"GQ",nom:"GuinÃ©e Ã‰quatoriale"},{codeIso:"ER",nom:"Ã‰rythrÃ©e"},{codeIso:"EE",nom:"Estonie"},{codeIso:"ET",nom:"Ã‰thiopie"},{codeIso:"FK",nom:"Falkland,  ÃŽles"},{codeIso:"FO",nom:"FÃ©roÃ©,  ÃŽles"},{codeIso:"FJ",nom:"Fidji"},{codeIso:"GA",nom:"Gabon"},{codeIso:"GM",nom:"Gambie"},{codeIso:"GE",nom:"GÃ©orgie"},{codeIso:"GH",nom:"Ghana"},{codeIso:"GD",nom:"Grenade"},{codeIso:"GL",nom:"Groenland"},{codeIso:"GI",nom:"Gibraltar"},{codeIso:"GP",nom:"Guadeloupe"},{codeIso:"GU",nom:"Guam"},{codeIso:"GT",nom:"Guatemala"},{codeIso:"GG",nom:"Guernesey"},{codeIso:"GN",nom:"GuinÃ©e"},{codeIso:"GW",nom:"GuinÃ©e-Bissau"},{codeIso:"GY",nom:"Guyana"},{codeIso:"HT",nom:"HaÃƒÂ®ti"},{codeIso:"HM",nom:"Heard,  ÃŽle et Mcdonald,  ÃŽles"},{codeIso:"VA",nom:"Saint-Siege (Ã‰tat de la CitÃ© du Vatican)"},{codeIso:"HN",nom:"Honduras"},{codeIso:"IS",nom:"Islande"},{codeIso:"IN",nom:"Inde"},{codeIso:"ID",nom:"IndonÃ©sie"},{codeIso:"IR",nom:"Iran"},{codeIso:"IQ",nom:"Iraq"},{codeIso:"IM",nom:"Man,  ÃŽle de"},{codeIso:"JM",nom:"Jamaique"},{codeIso:"JE",nom:"Jersey"},{codeIso:"JO",nom:"Jordanie"},{codeIso:"KZ",nom:"Kazakhstan"},{codeIso:"KE",nom:"Kenya"},{codeIso:"KI",nom:"Kiribati"},{codeIso:"KP",nom:"CorÃ©e, RÃ©p. Populaire DÃ©m. de"},{codeIso:"KW",nom:"KoweÃ¯t"},{codeIso:"KG",nom:"Kirghizistan"},{codeIso:"LA",nom:"Laos"},{codeIso:"LV",nom:"Lettonie"},{codeIso:"LB",nom:"Liban"},{codeIso:"LS",nom:"Lesotho"},{codeIso:"LR",nom:"LibÃ©ria"},{codeIso:"LY",nom:"Libyenne, Jamahiriya Arabe"},{codeIso:"LI",nom:"Liechtenstein"},{codeIso:"LT",nom:"Lituanie"},{codeIso:"MO",nom:"Macao"},{codeIso:"MK",nom:"MacÃ©doine"},{codeIso:"MG",nom:"Madagascar"},{codeIso:"MW",nom:"Malawi"},{codeIso:"MY",nom:"Malaisie"},{codeIso:"MV",nom:"Maldives"},{codeIso:"ML",nom:"Mali"},{codeIso:"MT",nom:"Malte"},{codeIso:"MH",nom:"Marshall,  ÃŽles"},{codeIso:"MQ",nom:"Martinique"},{codeIso:"MR",nom:"Mauritanie"},{codeIso:"HU",nom:"Hongrie"},{codeIso:"YT",nom:"Mayotte"},{codeIso:"MX",nom:"Mexique"},{codeIso:"FM",nom:"MicronÃ©sie"},{codeIso:"MD",nom:"Moldova"},{codeIso:"MC",nom:"Monaco"},{codeIso:"MN",nom:"Mongolie"},{codeIso:"ME",nom:"MontÃ©nÃ©gro"},{codeIso:"MS",nom:"Montserrat"},{codeIso:"MA",nom:"Maroc"},{codeIso:"MZ",nom:"Mozambique"},{codeIso:"NA",nom:"Namibie"},{codeIso:"NR",nom:"Nauru"},{codeIso:"NP",nom:"NÃ©pal"},{codeIso:"AN",nom:"Antilles NÃ©erlandaises"},{codeIso:"NC",nom:"Nouvelle-CalÃ©donie"},{codeIso:"NI",nom:"Nicaragua"},{codeIso:"NE",nom:"Niger"},{codeIso:"NU",nom:"NiuÃ©"},{codeIso:"NF",nom:"Norfolk,  ÃŽle"},{codeIso:"MP",nom:"Mariannes du Nord,  ÃŽles"},{codeIso:"OM",nom:"Oman"},{codeIso:"PK",nom:"Pakistan"},{codeIso:"PW",nom:"Palaos"},{codeIso:"PS",nom:"Palestinien OccupÃ©, Territoire"},{codeIso:"PA",nom:"Panama"},{codeIso:"PG",nom:"Papouasie-Nouvelle-GuinÃ©e"},{codeIso:"PY",nom:"Paraguay"},{codeIso:"PE",nom:"PÃ©rou"},{codeIso:"PH",nom:"Philippines"},{codeIso:"PN",nom:"Pitcairn"},{codeIso:"PR",nom:"Porto Rico"},{codeIso:"QA",nom:"Qatar"},{codeIso:"RE",nom:"RÃ©union,  ÃŽle de la"},{codeIso:"RU",nom:"Russie, FÃ©dÃ©ration de"},{codeIso:"RW",nom:"Rwanda"},{codeIso:"BL",nom:"Saint-BarthÃ©lemy"},{codeIso:"KN",nom:"Saint-Kitts-et-Nevis"},{codeIso:"LC",nom:"Sainte-Lucie"},{codeIso:"MF",nom:"Saint-Martin"},{codeIso:"PM",nom:"Saint-Pierre-et-Miquelon"},{codeIso:"VC",nom:"Saint-Vincent-et-Les Grenadines"},{codeIso:"WS",nom:"Samoa"},{codeIso:"SM",nom:"Saint-Marin"},{codeIso:"ST",nom:"Sao TomÃ©-et-Principe"},{codeIso:"SA",nom:"Arabie Saoudite"},{codeIso:"SN",nom:"SÃ©nÃ©gal"},{codeIso:"RS",nom:"Serbie"},{codeIso:"SC",nom:"Seychelles"},{codeIso:"SL",nom:"Sierra Leone"},{codeIso:"SI",nom:"SlovÃ©nie"},{codeIso:"SB",nom:"Salomon,  ÃŽles"},{codeIso:"SO",nom:"Somalie"},{codeIso:"GS",nom:"GÃ©orgie du Sud et les  ÃŽles Sandwich du Sud"},{codeIso:"LK",nom:"Sri Lanka"},{codeIso:"SD",nom:"Soudan"},{codeIso:"SR",nom:"Suriname"},{codeIso:"SJ",nom:"Svalbard et  ÃŽle Jan Mayen"},{codeIso:"SZ",nom:"Swaziland"},{codeIso:"SY",nom:"Syrienne"},{codeIso:"TW",nom:"TaÃ¯wan"},{codeIso:"TJ",nom:"Tadjikistan"},{codeIso:"TZ",nom:"Tanzanie"},{codeIso:"TH",nom:"ThaÃ¯lande"},{codeIso:"TK",nom:"Tokelau"},{codeIso:"TO",nom:"Tonga"},{codeIso:"TT",nom:"TrinitÃ©-et-Tobago"},{codeIso:"TN",nom:"Tunisie"},{codeIso:"TR",nom:"Turquie"},{codeIso:"TM",nom:"TurkmÃ©nistan"},{codeIso:"TC",nom:"Turks et Caiques,  ÃŽles"},{codeIso:"TV",nom:"Tuvalu"},{codeIso:"UG",nom:"Ouganda"},{codeIso:"UA",nom:"Ukraine"},{codeIso:"AE",nom:"Ã‰mirats Arabes Unis"},{codeIso:"UY",nom:"Uruguay"},{codeIso:"UZ",nom:"OuzbÃ©kistan"},{codeIso:"VU",nom:"Vanuatu"},{codeIso:"VE",nom:"Venezuela"},{codeIso:"VN",nom:"Vietnam"},{codeIso:"VG",nom:" ÃŽles Vierges Britanniques"},{codeIso:"VI",nom:" ÃŽles Vierges des Ã‰tats-Unis"},{codeIso:"WF",nom:"Wallis et Futuna"},{codeIso:"EH",nom:"Sahara Occidental"},{codeIso:"YE",nom:"YÃ©men"},{codeIso:"ZM",nom:"Zambie"},{codeIso:"ZW",nom:"Zimbabwe"},{codeIso:"AL",nom:"Albanie"},{codeIso:"AF",nom:"Afghanistan"},{codeIso:"AQ",nom:"Antarctique"},{codeIso:"BA",nom:"Bosnie-HerzÃ©govine"},{codeIso:"BV",nom:"Bouvet,  ÃŽle"},{codeIso:"IO",nom:"OcÃ©an Indien, Territoire Britannique de L'"},{codeIso:"BG",nom:"Bulgarie"},{codeIso:"KY",nom:"CaÃ¯mans,  ÃŽles"},{codeIso:"CX",nom:"Christmas,  ÃŽle"},{codeIso:"CC",nom:"Cocos (Keeling),  ÃŽles"},{codeIso:"CK",nom:"Cook,  ÃŽles"},{codeIso:"GF",nom:"Guyane FranÃ§aise"},{codeIso:"PF",nom:"PolynÃ©sie FranÃ§aise"},{codeIso:"TF",nom:"Terres Australes FranÃ§aises"},{codeIso:"AX",nom:"Ãƒâ€¦land,  ÃŽles"}]},function(e,o){e.exports=t},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(4),a=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=a.default},function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),d=o(0),c=n(d),i=o(5),m=n(i),u=o(6),f=n(u),I=o(7),p=n(I),E=o(8),y=n(E),v=o(9),g=n(v),b=o(1),h=o(2),S=(y.default.CancelToken,p.default._loadScript),M=function(e){function t(e){a(this,t);var o=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.clickOnLogo=function(e){"edit"===o.props.mode&&e({action:"click_img_logo"})},o.state={isLoadedJsPdf:!1},o.cfgSite=p.default._store.getConfigSite(),o}return r(t,e),s(t,[{key:"componentWillMount",value:function(){this.loadData()}},{key:"componentDidUpdate",value:function(){}},{key:"loadData",value:function(e){}},{key:"formatDate",value:function(e){return h(e).format("DD/MM/YYYY à HH:mm")}},{key:"componentDidMount",value:function(){"edit"!==this.mode&&this.loadJsPdf()}},{key:"loadJsPdf",value:function(){var e=this;S("https://unpkg.com/jspdf@1.5.3/dist/jspdf.min.js","js","script-jspdf").then(function(){S("https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.2.4/jspdf.plugin.autotable.min.js","js","script-jspdf-table").then(function(){e.setState({isLoadedJsPdf:!0})})})}},{key:"sanitizeDiscounts",value:function(e){var t=[];for(var o in e.items)for(var n in e.items[o].discounts)-1==t.indexOf(e.items[o].discounts[n].id)&&t.push(e.items[o].discounts[n].id);for(var a in e.discounts)t.indexOf(e.discounts[a].id)>-1&&e.discounts.splice(t.indexOf(e.discounts[a].id),1)}},{key:"calculateCoupon",value:function(e){var t=0,o=0;for(var n in e.items)t+=e.items[n].totalTax;var a={value:0},l=0;e.discounts.length>0&&(a=e.discounts[0])&&(l=a.is_percent?e.subtotal*(a.value/100):a.value);var r=0;return t>0&&(r=a.is_percent?t*(a.value/100):a.value*(t/e.subtotal)),o=t-r,{ttc:l,ht:l-r,tva:r,totalTva:o,totalHt:e.totalTtc-o}}},{key:"formatPersoLabels",value:function(e,t,o){return c.default.createElement("tr",{key:t},c.default.createElement("td",{scope:"row"},c.default.createElement("small",null,c.default.createElement("b",{dangerouslySetInnerHTML:{__html:e.title}})),c.default.createElement("br",null),c.default.createElement("div",null,c.default.createElement("small",{dangerouslySetInnerHTML:{__html:e.data}}))))}},{key:"renderPersoLabels",value:function(e){var t=this,o=void 0;if("product"==e.catalog_item&&Array.isArray(e.metadata)&&e.metadata.length>0)for(var n in e.metadata)void 0!==e.metadata[n].personnalisation_friendly&&(o=c.default.createElement("table",{className:"table"},c.default.createElement("tbody",{className:"results_panier"},e.metadata[n].personnalisation_friendly.map(function(e,o){return t.formatPersoLabels(e,o)}))));return o}},{key:"formatTitle",value:function(){var e=this.props.theFacture,t=e.paid,o=e.number,n=this.props.prefixFacture;return t?"Facture :"+n+" "+o:"Bon de commande :"+o}},{key:"parseNddName",value:function(e){var t="";return e.metadata&&e.metadata.length>0&&void 0!==e.metadata[0].domain_name&&(t=[c.default.createElement("small",{key:"0"},"www. ",e.metadata[0].domain_name),c.default.createElement("br",{key:"1"})]),t}},{key:"render",value:function(){var e=this,t=this.props,o=t.theFacture,n=t.logo,a=t.infosLegales,l=t.cmdCanceled,r=t.cmdPaye,s=t.msg_tva,d=t.mode,i=t.onAction,u=t.prefixFacture,I=this.state.isLoadedJsPdf,p=s,E=a,y=n,v=u;"edit"!==d&&this.cfgSite.global&&(p=this.cfgSite.global.msg_tva||"",E=this.cfgSite.global.infosLegales||"",y=this.cfgSite.global.logo,v=this.cfgSite.global.prefixFacture||"");var h=!o.taxable,S={fontSize:"1.5rem"},M="edit"===d,T=!!y,P={img:{path:y},tpl:"img",visible:T};return this.sanitizeDiscounts(o),c.default.createElement("div",{"data-rcpt":"facture"},c.default.createElement("div",{className:"container text-dark bg-white py-2"},c.default.createElement("div",{className:"pdf"},c.default.createElement("div",{className:"row"},l?c.default.createElement("div",{className:"col-sm-12"},c.default.createElement("div",{className:"text-center",style:S},"Commande annulée")):0==r?c.default.createElement("div",{className:"col-sm-12"},c.default.createElement("div",{className:"text-center",style:S},"Commande non payée")):"",c.default.createElement("div",{className:"col-sm-12"},c.default.createElement("div",{className:"invoice-title"},c.default.createElement("div",{className:"text-right",style:S},"Mandat Administratif"==o.paiement.nom&&"Facture Proforma -",c.default.createElement("span",null)),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-12"},c.default.createElement("div",{className:"media"},c.default.createElement("div",{className:"img-container"},c.default.createElement(f.default,{item:P,style:{maxHeight:"120px"},onAction:function(){return e.clickOnLogo(i)}})),c.default.createElement("div",{className:"media-body ml-2"},M&&c.default.createElement(m.default,{content:E,block:"infosLegales",onAction:function(e){return i({action:"evt_draft",params:e})}})||c.default.createElement("div",{dangerouslySetInnerHTML:{__html:E}}))))),c.default.createElement("hr",null),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-sm-6 text-left"},o.delivery&&o.delivery.address&&c.default.createElement("address",null,c.default.createElement("strong",null,"Adresse de livraison :"),c.default.createElement("br",null),o.delivery.address.company_name?c.default.createElement("span",null,o.delivery.address.company_name):c.default.createElement("span",null,o.delivery.address.firstname," ",o.delivery.address.name),c.default.createElement("br",null),o.delivery.address.address,c.default.createElement("br",null),o.delivery.address.address2&&[o.delivery.address.address2,c.default.createElement("br",{key:"1"})],o.delivery.address.postal_code,","," ",o.delivery.address.town,c.default.createElement("br",null),(0,b.getCountryName)(o.delivery.address.country),c.default.createElement("br",null),o.delivery.address.mobile&&["mobile: "+o.delivery.address.mobile,c.default.createElement("br",{key:"2"})],o.delivery.address.telephone&&["tel: "+o.delivery.address.telephone,c.default.createElement("br",{key:"3"})])),c.default.createElement("div",{className:"col-sm-"+(o.delivery?"6":"12")+" text-right"},o.customer.address&&c.default.createElement("address",null,c.default.createElement("strong",null,"Adresse de facturation :"),c.default.createElement("br",null),o.customer.address.company_name?c.default.createElement("span",null,o.customer.address.company_name):c.default.createElement("span",null,o.customer.address.firstname," ",o.customer.address.name),c.default.createElement("br",null),o.customer.address.address,c.default.createElement("br",null),o.customer.address.address2&&[o.customer.address.address2,c.default.createElement("br",{key:"1"})],o.customer.address.postal_code,","," ",o.customer.address.town,c.default.createElement("br",null),(0,b.getCountryName)(o.customer.address.country),c.default.createElement("br",null),o.customer.address.telephone&&["tel: "+o.customer.address.telephone,c.default.createElement("br",{key:"3"})],o.customer.email&&["email: "+o.customer.email,c.default.createElement("br",{key:"4"})]))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-sm-6"},c.default.createElement("address",null,c.default.createElement("strong",null,"Mode de paiement : "),o.paiement.name," ",c.default.createElement("br",null))),c.default.createElement("div",{className:"col-sm-6 text-right"},c.default.createElement("address",null,c.default.createElement("strong",null,"Date : "),this.formatDate(o.created_at.date),c.default.createElement("br",null))))))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-md-12"},c.default.createElement("div",{className:"card"},c.default.createElement("div",{className:"card-header"},c.default.createElement("strong",null," ",this.formatTitle())),c.default.createElement("div",{className:"card-body"},c.default.createElement("div",{className:"table-responsive"},c.default.createElement("table",{id:"basic-table",className:"table"},c.default.createElement("thead",null,c.default.createElement("tr",null,c.default.createElement("th",null,"Référence"),c.default.createElement("th",null,"Produit"),0==h&&c.default.createElement("th",null,"Prix HT "),c.default.createElement("th",null,"Qté"),0==h&&c.default.createElement("th",null,"Tx TVA"),0==h&&c.default.createElement("th",null,"Total TVA"),c.default.createElement("th",null,"Total TTC"))),c.default.createElement("tbody",null,o.items.map(function(t,o){return c.default.createElement("tr",{key:o},c.default.createElement("td",null,t.sku,"delivery"==t.catalog_item&&c.default.createElement("span",null,"Livraison ",c.default.createElement("br",null))),c.default.createElement("td",null,t.name,c.default.createElement("br",null),c.default.createElement("span",null,e.parseNddName(t)),t.promos.map(function(e,t){return c.default.createElement("span",{key:t,className:"badge badge-primary"},c.default.createElement("small",null,"PROMO -",(0,b.formatPrice)(e.value,h),1==e.is_percent?"%":e.currency))}),c.default.createElement("br",null),t.discounts.map(function(e,t){return c.default.createElement("span",{key:t,className:"badge badge-light"},e.coupon,c.default.createElement("span",null,"-",e.value,1==e.is_percent?"%":e.currency))}),e.renderPersoLabels(t)),0==h&&c.default.createElement("td",null,(0,b.formatPrice)(t.totalHt,h)," ",c.default.createElement("br",null)),c.default.createElement("td",null,t.quantity),0==h&&c.default.createElement("td",null,t.taxes.length>0&&c.default.createElement("span",null," ",t.taxes[0].tax_rate," %")),0==h&&c.default.createElement("td",null,c.default.createElement("span",null," ",(0,b.formatPrice)(t.totalTax,h)," ")),0==h?c.default.createElement("td",null,(0,b.formatPrice)(t.totalTtc,h)," ",c.default.createElement("br",null),(t.discounts.length>0||t.promos.length>0)&&c.default.createElement("span",null,c.default.createElement("del",null,(0,b.formatPrice)(t.totalTtcBeforeDiscount,h)))):c.default.createElement("td",null,(0,b.formatPrice)(t.totalTtc,h),c.default.createElement("br",null),(t.discounts.length>0||t.promos.length>0)&&c.default.createElement("span",null,c.default.createElement("del",null,(0,b.formatPrice)(t.totalTtcBeforeDiscount,h)))))}),o.discounts.map(function(t,n){return c.default.createElement("tr",{key:n},c.default.createElement("td",null,"Coupon",t.sku),c.default.createElement("td",null,t.coupon,c.default.createElement("br",null),c.default.createElement("span",null," ","-",t.value," ",1==t.is_percent?"%":o.currency)),0==h?c.default.createElement("td",null,"-",(0,b.formatPrice)(e.calculateCoupon(o).ht,h)):c.default.createElement("td",null),c.default.createElement("td",null,"1"),0==h&&c.default.createElement("td",null),0==h&&c.default.createElement("td",null,c.default.createElement("span",null," ","-",(0,b.formatPrice)(e.calculateCoupon(o).tva,h)," ")),c.default.createElement("td",null,"-",(0,b.formatPrice)(e.calculateCoupon(o).ttc,h)))})),c.default.createElement("tfoot",null,c.default.createElement("tr",null,c.default.createElement("td",null),c.default.createElement("td",null,"TOTAL"),0==h&&c.default.createElement("td",null,o.discounts.length>0&&c.default.createElement("span",null,(0,b.formatPrice)(this.calculateCoupon(o).totalHt,h)," ",o.currency),0==o.discounts.length&&c.default.createElement("span",null,(0,b.formatPrice)(o.totalHt,h)," ",o.currency)),c.default.createElement("td",null),0==h&&c.default.createElement("td",null),0==h&&c.default.createElement("td",null,o.discounts.length>0&&c.default.createElement("span",null,(0,b.formatPrice)(this.calculateCoupon(o).totalTva,h)," ",o.currency),0==o.discounts.length&&c.default.createElement("span",null,(0,b.formatPrice)(o.totalTtc-o.totalHt,h)," ",o.currency)),c.default.createElement("td",null,(0,b.formatPrice)(o.totalTtc,!0)," ",o.currency))))))))),c.default.createElement("div",{className:"row"},c.default.createElement("div",{className:"col-sm-12"},c.default.createElement("address",null,c.default.createElement("br",null),o.delivery&&o.delivery.tracking_code&&c.default.createElement("div",null,c.default.createElement("p",null,""!=o.delivery.tracking_code&&c.default.createElement("span",null,c.default.createElement("strong",null,"Numéro de suivi de colis :",c.default.createElement("br",null)," "),o.delivery.tracking_code,c.default.createElement("br",null)))),M&&c.default.createElement(m.default,{content:p,block:"msg_tva",onAction:function(e){return i({action:"evt_draft",params:e})}})||c.default.createElement("div",{dangerouslySetInnerHTML:{__html:p}}))))),!M&&I&&c.default.createElement(g.default,{cmdCanceled:l,theFacture:o,hasLogo:T,infosLegales:E,msg_tva:p,logo:y,prefixFacture:v})))}}]),t}(d.Component);M.defaultProps={logo:"",msg_tva:"<p><strong>TVA non applicable, article 293 B du CGI</strong></p>",infosLegales:"<p><em>Informations légales de la boutique non renseignées.</em></p>",prefixFacture:"Bon de commande",prefixClass:"",mode:"view",sectionClassName:"",bg:{class:"bg-white",img:{path:"",class:""}},show_title:!1,master_mode:!1,user_uid:null,step:"final",onAction:function(){}},t.default=M},function(e,t){e.exports=o},function(e,t){e.exports=n},function(e,t){e.exports=a},function(e,t){e.exports=l},function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=o(0),d=function(e){return e&&e.__esModule?e:{default:e}}(s),c=o(1),i=o(2),m=function(e){function t(e){n(this,t);var o=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return o.filterTxt=function(e){var t=e,o=document.createElement("div");return o.innerHTML=t,o.textContent||o.innerText||""},o.createPDF=function(){var e=o.props,t=e.hasLogo,n=e.infosLegales,a=e.msg_tva,l=e.theFacture,r=e.prefixFacture,s=o.state.imgBase64,d=!l.taxable,m=l.paid?"facture":"bon_commande",u=m+"_"+(r+l.number)+"_"+i().format("DD_MM_YYYY"),f=19,I=19,p=new window.jsPDF,E=document.getElementById("basic-table"),y=(p.autoTableHtmlToJson(E),!!t),v=s,g=o.filterTxt(n).split(/\r\n|\r|\n/),b=g.length;p.setFontSize(11),p.setFontStyle("bold");var h={w:25,h:25};y&&""!=v&&p.addImage(v,"PNG",p.internal.pageSize.width-15-h.w,f,h.w,h.h);var S=3;p.setFontStyle("normal");for(var M=0;M<b;M++)p.text(g[M],15,f+S),S+=5;p.setFontStyle("bold"),I=f+=S>h.h||!y?S-5:h.h,p.setFontStyle("bold"),p.text(o.formatTitle(),p.internal.pageSize.width-15,16,"right");var T=I=f+=5;if(p.setDrawColor(238,238,238),p.line(15,T,p.internal.pageSize.width-15,T),l.delivery){p.text("Adresse de livraison :",15,f+=7),p.setFontStyle("normal");var P=l.delivery.address.company_name?l.delivery.address.company_name:l.delivery.address.firstname+" "+l.delivery.address.name;p.text(P,15,f+=10),p.text(""+l.delivery.address.address,15,f+=5),l.delivery.address.address2&&p.text(""+l.delivery.address.address2,15,f+=5),p.text(l.delivery.address.postal_code+", "+l.delivery.address.town,15,f+=5),p.text((0,c.getCountryName)(l.delivery.address.country),15,f+=5)}var x=l.customer.address.company_name?l.customer.address.company_name:l.customer.address.firstname+" "+l.customer.address.name;p.setFontStyle("bold"),p.text("Adresse de facturation :",p.internal.pageSize.width-15,I+=7,"right"),p.setFontSize(11),p.setFontStyle("normal"),p.text(x,p.internal.pageSize.width-15,I+=10,"right"),p.text(""+l.customer.address.address,p.internal.pageSize.width-15,I+=5,"right"),l.customer.address.address2&&p.text(l.customer.address.address2,p.internal.pageSize.width-15,I+=5,"right"),p.text(l.customer.address.postal_code+", "+l.customer.address.town,p.internal.pageSize.width-15,I+=5,"right");var _=(0,c.getCountryName)(l.customer.address.country);p.text(_,p.internal.pageSize.width-(-1===_.indexOf("(")?15:13),I+=5,"right"),p.text(l.customer.address.telephone,p.internal.pageSize.width-15,I+=5,"right"),p.text(l.customer.email,p.internal.pageSize.width-15,I+=5,"right");var C=f>I?f+10:I+10;p.text("Mode de paiement : "+l.paiement.name,15,C),p.text("Date : "+o.formatDate(l.created_at.date),p.internal.pageSize.width-15,C,"right"),p.autoTable({html:"#basic-table",startY:C+8,showHead:"firstPage",theme:"grid",footStyles:{fillColor:null,textColor:[51,51,51],lineWidth:.1},minCellWidth:"wrap",columnStyles:{0:0==d?{cellWidth:20}:null,1:{cellWidth:70},3:0==d?{cellWidth:10}:null},didParseCell:function(e){"body"===e.row.section&&-1===[0,1].indexOf(e.column.dataKey)&&(e.cell.styles.halign="center"),"foot"===e.row.section&&-1===[0,1].indexOf(e.column.dataKey)&&(e.cell.styles.halign="center")},didDrawCell:function(e){var t=e.column.dataKey===e.table.columns.length-1;if("body"===e.row.section&&t){if(e.cell.text[1]){p.setDrawColor("#000000");var o=e.cell.textPos.x-e.table.columns.length-1,n=e.cell.textPos.x+e.table.columns.length+1,a=e.cell.textPos.y+2;p.line(o,a,n,a)}}},headStyles:{fillColor:[255,255,255],textColor:[51,51,51],lineWidth:.1},styles:{overflow:"linebreak",valign:"middle"}});var N=p.autoTable.previous.finalY;p.text("",15,N+=5),p.text(""+o.filterTxt(a),15,N+=5),p.save(u)},o.state={imgBase64:""},o}return l(t,e),r(t,[{key:"formatTitle",value:function(){var e=this.props.theFacture,t=e.paid,o=e.number,n=this.props.prefixFacture;return t?"Facture :"+n+" "+o:"Bon de commande :"+o}},{key:"formatDate",value:function(e){return i(e).format("DD/MM/YYYY à HH:mm")}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props;e.hasLogo,e.logo;return d.default.createElement("button",{className:"cursor-pt btn btn-primary",id:"download",onClick:this.createPDF},"Télécharger en format PDF")}}]),t}(s.Component);m.defaultProps={},t.default=m}])});